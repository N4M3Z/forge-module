# Copilot Instructions for forge-module

## What This Project Does

forge-module is a template for creating forge modules -- plugins that teach AI coding assistants your project's conventions. It ships with one example agent (ExampleAgent) and one example skill (ExampleConventions). Clone it, rename the examples, add your conventions, and deploy to Claude Code, Gemini CLI, Codex, or OpenCode.

## High-Level Architecture

### Core Components

**agents/** -- 1 example agent (ExampleAgent.md):
- Frontmatter: `name` (PascalCase), `description`, `version`
- Deployment config (model, tools, scope) in `defaults.yaml`
- Body: Role, Expertise, Instructions, Output Format, Constraints

**skills/** -- 1 example skill (ExampleConventions/):
- `SKILL.md` -- skill instructions
- `SKILL.yaml` -- metadata and provider routing

**defaults.yaml** -- canonical agent roster, skill config, and provider model tiers. Single source of truth for deployment.

**lib/** -- git submodule pointing to forge-lib. Provides Rust binaries:
- `bin/install-agents` -- multi-provider agent deployment
- `bin/install-skills` -- provider-aware skill installer
- `bin/validate-module` -- convention test suite

## Build, Test, Verify

```bash
make install          # deploy agent + skill for all providers (SCOPE=workspace|user|all)
make verify           # check agent deployed + skill present
make test             # run module validation (validate-module)
make lint             # shellcheck all scripts
make clean            # remove previously installed agents
```

## Key Conventions

### Agent Structure

Every agent file follows: frontmatter (name, description, version) + body (blockquote, Role, Expertise, Instructions, Output Format, Constraints). Constraints must include honesty clause and team communication clause.

### Configuration

- `defaults.yaml`: Canonical roster and provider config. Edit when adding agents.
- `config.yaml`: User overrides (gitignored). Same structure, only changed fields.
- `module.yaml`: Module metadata. Update `version` on releases.

### Git Conventions

Conventional Commits: `type: description`. Lowercase, no period, no scope.
Types: `feat`, `fix`, `docs`.

## File Organization

```
agents/                      1 example agent markdown file
skills/                      1 example skill dir (SKILL.md + SKILL.yaml)
lib/                         git submodule -> forge-lib (Rust binaries)
defaults.yaml                agent roster + provider config
config.yaml                  user overrides (gitignored)
module.yaml                  module metadata (name, version)
.claude-plugin/              plugin.json for Claude Code plugin discovery
.claude/                     generated by `make install` (gitignored)
.gemini/                     generated by `make install` (gitignored)
.codex/                      generated by `make install` (gitignored)
.opencode/                   generated by `make install` (gitignored)
README.md                    user-facing overview
INSTALL.md                   installation guide
VERIFY.md                    post-install verification
CLAUDE.md                    Claude Code context (autogenerated)
GEMINI.md                    Gemini CLI context (autogenerated)
AGENTS.md                    Codex/OpenCode context (autogenerated)
```

## Important Notes

- **Do not edit** AGENTS.md, GEMINI.md, or CLAUDE.md directly -- these are autogenerated.
- Platform directories (`.claude/`, `.gemini/`, `.codex/`, `.opencode/`) are gitignored -- never edit directly.
- Source of truth is `agents/`, `skills/`, and `defaults.yaml`.
